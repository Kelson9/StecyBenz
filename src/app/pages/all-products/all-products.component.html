<app-header></app-header>
<div class="featured-products-page">
  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <div class="hero-text">
        <h1 class="hero-title">
          <span class="gradient-text">Featured</span> Beauty Products
        </h1>
        <p class="hero-subtitle">Discover our handpicked selection of premium beauty essentials, curated just for you</p>
        <div class="hero-stats">
          <div class="stat">
            <span class="stat-number">500+</span>
            <span class="stat-label">Premium Products</span>
          </div>
          <div class="stat">
            <span class="stat-number">50+</span>
            <span class="stat-label">Luxury Brands</span>
          </div>
          <div class="stat">
            <span class="stat-number">10k+</span>
            <span class="stat-label">Happy Customers</span>
          </div>
        </div>
      </div>
      <div class="hero-visual">
        <div class="floating-products">
          <div class="floating-product" *ngFor="let item of featuredItems; let i = index" 
               [style.animation-delay]="i * 0.2 + 's'">
            <img [src]="item.image" [alt]="item.name">
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Sidebar Filters -->
    <aside class="filters-sidebar" [class.open]="filtersOpen">
      <div class="filters-header">
        <h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="22,3 2,3 10,12.46 10,19 14,21 14,12.46"/>
          </svg>
          Filters
        </h3>
        <button class="close-filters" (click)="toggleFilters()" *ngIf="filtersOpen">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>

      <div class="filters-content">
        <!-- Search Filter -->
        <div class="filter-group">
          <label class="filter-label">Search Products</label>
          <div class="search-input-wrapper">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="M21 21l-4.35-4.35"/>
            </svg>
            <input 
              type="text" 
              placeholder="Search by name, brand, or category..."
              [(ngModel)]="filters.search"
              (input)="applyFilters()"
              class="search-input">
          </div>
        </div>

        <!-- Category Filter -->
        <div class="filter-group">
          <label class="filter-label">Categories</label>
          <div class="checkbox-list">
            <label class="checkbox-item" *ngFor="let category of categories">
              <input 
                type="checkbox" 
                [value]="category.id"
                [checked]="filters.categories.includes(category.id)"
                (change)="onCategoryChange(category.id, $event)">
              <span class="checkmark"></span>
              <span class="label-text">{{ category.name }}</span>
              <span class="count">({{ category.count }})</span>
            </label>
          </div>
        </div>

        <!-- Brand Filter -->
        <div class="filter-group">
          <label class="filter-label">Brands</label>
          <div class="brand-list">
            <div class="brand-item" 
                 *ngFor="let brand of brands" 
                 [class.selected]="filters.brands.includes(brand.id)"
                 (click)="toggleBrand(brand.id)">
              <img [src]="brand.logo" [alt]="brand.name" class="brand-logo">
              <span class="brand-name">{{ brand.name }}</span>
            </div>
          </div>
        </div>

        <!-- Price Range Filter -->
        <div class="filter-group">
          <label class="filter-label">Price Range</label>
          <div class="price-range">
            <div class="range-inputs">
              <input 
                type="number" 
                placeholder="Min"
                [(ngModel)]="filters.priceRange.min"
                (input)="applyFilters()"
                class="price-input">
              <span class="range-separator">to</span>
              <input 
                type="number" 
                placeholder="Max"
                [(ngModel)]="filters.priceRange.max"
                (input)="applyFilters()"
                class="price-input">
            </div>
            <div class="price-slider">
              <input 
                type="range" 
                min="0" 
                max="500" 
                [(ngModel)]="filters.priceRange.min"
                (input)="applyFilters()"
                class="range-min">
              <input 
                type="range" 
                min="0" 
                max="500" 
                [(ngModel)]="filters.priceRange.max"
                (input)="applyFilters()"
                class="range-max">
            </div>
          </div>
        </div>

        <!-- Rating Filter -->
        <div class="filter-group">
          <label class="filter-label">Customer Rating</label>
          <div class="rating-filter">
            <div class="rating-option" 
                 *ngFor="let rating of ratingOptions" 
                 [class.selected]="filters.minRating === rating.value"
                 (click)="setMinRating(rating.value)">
              <div class="stars">
                <span *ngFor="let star of [1,2,3,4,5]" 
                      class="star" 
                      [class.filled]="star <= rating.value">★</span>
              </div>
              <span class="rating-text">{{ rating.label }}</span>
            </div>
          </div>
        </div>

        <!-- Availability Filter -->
        <div class="filter-group">
          <label class="filter-label">Availability</label>
          <div class="toggle-list">
            <label class="toggle-item">
              <input 
                type="checkbox" 
                [(ngModel)]="filters.inStock"
                (change)="applyFilters()">
              <span class="toggle-switch"></span>
              <span class="toggle-label">In Stock Only</span>
            </label>
            <label class="toggle-item">
              <input 
                type="checkbox" 
                [(ngModel)]="filters.onSale"
                (change)="applyFilters()">
              <span class="toggle-switch"></span>
              <span class="toggle-label">On Sale</span>
            </label>
            <label class="toggle-item">
              <input 
                type="checkbox" 
                [(ngModel)]="filters.newArrivals"
                (change)="applyFilters()">
              <span class="toggle-switch"></span>
              <span class="toggle-label">New Arrivals</span>
            </label>
          </div>
        </div>

        <!-- Clear Filters -->
        <div class="filter-actions">
          <button class="clear-btn" (click)="clearFilters()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 6h18"/>
              <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
              <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
            </svg>
            Clear All Filters
          </button>
        </div>
      </div>
    </aside>

    <!-- Products Content -->
    <main class="products-content">
      <!-- Toolbar -->
      <div class="products-toolbar">
        <div class="toolbar-left">
          <button class="filter-toggle" (click)="toggleFilters()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polygon points="22,3 2,3 10,12.46 10,19 14,21 14,12.46"/>
            </svg>
            Filters
          </button>
          <div class="results-count">
            <span class="count">{{ filteredProducts.length }}</span> 
            <span class="text">{{ filteredProducts.length === 1 ? 'product' : 'products' }} found</span>
          </div>
        </div>

        <div class="toolbar-right">
          <div class="view-options">
            <button class="view-btn" 
                    [class.active]="viewMode === 'grid'"
                    (click)="setViewMode('grid')">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7"/>
                <rect x="14" y="3" width="7" height="7"/>
                <rect x="14" y="14" width="7" height="7"/>
                <rect x="3" y="14" width="7" height="7"/>
              </svg>
            </button>
            <button class="view-btn" 
                    [class.active]="viewMode === 'list'"
                    (click)="setViewMode('list')">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="8" y1="6" x2="21" y2="6"/>
                <line x1="8" y1="12" x2="21" y2="12"/>
                <line x1="8" y1="18" x2="21" y2="18"/>
                <line x1="3" y1="6" x2="3.01" y2="6"/>
                <line x1="3" y1="12" x2="3.01" y2="12"/>
                <line x1="3" y1="18" x2="3.01" y2="18"/>
              </svg>
            </button>
          </div>

          <div class="sort-dropdown">
            <select [(ngModel)]="sortBy" (change)="applySorting()" class="sort-select">
              <option value="featured">Featured</option>
              <option value="name-asc">Name (A-Z)</option>
              <option value="name-desc">Name (Z-A)</option>
              <option value="price-asc">Price (Low to High)</option>
              <option value="price-desc">Price (High to Low)</option>
              <option value="rating">Highest Rated</option>
              <option value="newest">Newest First</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Active Filters -->
      <div class="active-filters" *ngIf="hasActiveFilters()">
        <div class="filter-tags">
          <span class="filter-tag" *ngFor="let category of getSelectedCategories()">
            {{ category.name }}
            <button (click)="removeCategory(category.id)">×</button>
          </span>
          <span class="filter-tag" *ngFor="let brand of getSelectedBrands()">
            {{ brand.name }}
            <button (click)="removeBrand(brand.id)">×</button>
          </span>
          <span class="filter-tag" *ngIf="filters.priceRange.min || filters.priceRange.max">
            ${{ filters.priceRange.min || 0 }} - ${{ filters.priceRange.max || 500 }}
            <button (click)="clearPriceRange()">×</button>
          </span>
        </div>
        <button class="clear-all" (click)="clearFilters()">Clear All</button>
      </div>

      <!-- Products Grid/List -->
      <div class="products-container" [class.list-view]="viewMode === 'list'">
        <!-- Loading State -->
        <div class="loading-state" *ngIf="isLoading">
          <div class="loading-animation">
            <div class="loading-dots">
              <div class="dot"></div>
              <div class="dot"></div>
              <div class="dot"></div>
            </div>
            <p>Loading amazing products...</p>
          </div>
        </div>

        <!-- Products Grid -->
        <div class="products-grid" *ngIf="!isLoading && filteredProducts.length > 0">
          <div class="product-card" 
               *ngFor="let product of paginatedProducts; trackBy: trackProduct"
               [@cardAnimation]>
            
            <!-- Product Image -->
            <div class="product-image">
              <img [src]="product.image" [alt]="product.name" (load)="onImageLoad($event)">
              
              <!-- Product Badges -->
              <div class="product-badges">
                <span class="badge new" *ngIf="product.isNew">New</span>
                <span class="badge sale" *ngIf="product.onSale">
                  -{{ product.discountPercentage }}%
                </span>
                <span class="badge bestseller" *ngIf="product.isBestseller">Bestseller</span>
              </div>

              <!-- Quick Actions -->
              <div class="quick-actions">
                <button class="quick-btn" (click)="quickView(product)" title="Quick View">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                    <circle cx="12" cy="12" r="3"/>
                  </svg>
                </button>
                <button class="quick-btn" 
                        [class.active]="product.isFavorite"
                        (click)="toggleWishlist(product)" 
                        title="Add to Wishlist">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                  </svg>
                </button>
                <button class="quick-btn" (click)="addToCart(product)" title="Add to Cart">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"/>
                    <circle cx="20" cy="21" r="1"/>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                  </svg>
                </button>
              </div>
            </div>

            <!-- Product Info -->
            <div class="product-info">
              <div class="product-brand">{{ product.brand }}</div>
              <h3 class="product-name">{{ product.name }}</h3>
              
              <!-- Rating -->
              <div class="product-rating">
                <div class="stars">
                  <span *ngFor="let star of [1,2,3,4,5]" 
                        class="star" 
                        [class.filled]="star <= product.rating">★</span>
                </div>
                <span class="rating-count">({{ product.reviewCount }})</span>
              </div>

              <!-- Price -->
              <div class="product-price">
                <span class="current-price">${{ product.price | number:'1.2-2' }}</span>
                <span class="original-price" *ngIf="product.originalPrice">
                  ${{ product.originalPrice | number:'1.2-2' }}
                </span>
              </div>

              <!-- Stock Status -->
              <div class="stock-status" [class.low-stock]="product.stock < 10">
                <span *ngIf="product.stock > 10" class="in-stock">In Stock</span>
                <span *ngIf="product.stock <= 10 && product.stock > 0" class="low-stock">
                  Only {{ product.stock }} left
                </span>
                <span *ngIf="product.stock === 0" class="out-of-stock">Out of Stock</span>
              </div>

              <!-- Add to Cart Button -->
              <button class="add-to-cart-btn" 
                      [disabled]="product.stock === 0"
                      (click)="addToCart(product)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="9" cy="21" r="1"/>
                  <circle cx="20" cy="21" r="1"/>
                  <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                </svg>
                {{ product.stock === 0 ? 'Out of Stock' : 'Add to Cart' }}
              </button>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="!isLoading && filteredProducts.length === 0">
          <div class="empty-illustration">
            <svg width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
              <circle cx="11" cy="11" r="8"/>
              <path d="M21 21l-4.35-4.35"/>
            </svg>
          </div>
          <h3>No products found</h3>
          <p>Try adjusting your filters or search terms to find what you're looking for.</p>
          <button class="clear-filters-btn" (click)="clearFilters()">Clear All Filters</button>
        </div>
      </div>

      <!-- Pagination -->
      <div class="pagination" *ngIf="filteredProducts.length > itemsPerPage">
        <button class="page-btn prev" 
                [disabled]="currentPage === 1"
                (click)="previousPage()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M15 18l-6-6 6-6"/>
          </svg>
          Previous
        </button>

        <div class="page-numbers">
          <button *ngFor="let page of getPageNumbers()" 
                  class="page-number"
                  [class.active]="page === currentPage"
                  [class.ellipsis]="page === '...'"
                  [disabled]="page === '...'"
                  (click)="goToPage(page)">
            {{ page }}
          </button>
        </div>

        <button class="page-btn next" 
                [disabled]="currentPage === totalPages"
                (click)="nextPage()">
          Next
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 18l6-6-6-6"/>
          </svg>
        </button>
      </div>
    </main>
  </div>
</div>

<!-- Quick View Modal -->
<div class="modal-overlay" *ngIf="showQuickView" (click)="closeQuickView()">
  <div class="quick-view-modal" (click)="$event.stopPropagation()">
    <button class="modal-close" (click)="closeQuickView()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
    
    <div class="modal-content" *ngIf="selectedProduct">
      <div class="modal-image">
        <img [src]="selectedProduct.image" [alt]="selectedProduct.name">
      </div>
      <div class="modal-info">
        <div class="product-brand">{{ selectedProduct.brand }}</div>
        <h2>{{ selectedProduct.name }}</h2>
        <div class="product-rating">
          <div class="stars">
            <span *ngFor="let star of [1,2,3,4,5]" 
                  class="star" 
                  [class.filled]="star <= selectedProduct.rating">★</span>
          </div>
          <span class="rating-count">({{ selectedProduct.reviewCount }} reviews)</span>
        </div>
        <div class="product-price">
          <span class="current-price">${{ selectedProduct.price | number:'1.2-2' }}</span>
          <span class="original-price" *ngIf="selectedProduct.originalPrice">
            ${{ selectedProduct.originalPrice | number:'1.2-2' }}
          </span>
        </div>
        <p class="product-description">{{ selectedProduct.description }}</p>
        <div class="modal-actions">
          <button class="btn-secondary" (click)="toggleWishlist(selectedProduct)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
            </svg>
            {{ selectedProduct.isFavorite ? 'Remove from' : 'Add to' }} Wishlist
          </button>
          <button class="btn-primary" (click)="addToCart(selectedProduct)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="21" r="1"/>
              <circle cx="20" cy="21" r="1"/>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
            </svg>
            Add to Cart
          </button>
        </div>
      </div>
    </div>
  </div>
</div>